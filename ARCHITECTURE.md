# System Architecture & Flow Diagrams

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEVICE-CITY-LOADER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   CLIENT (React + Vite)                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   Dashboard     â”‚          â”‚   Admin Panel       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   (Main Page)   â”‚          â”‚   (/admin/ads)      â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚           â”‚                            â”‚               â”‚  â”‚
â”‚  â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚
â”‚  â”‚           â”‚                 â”‚                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚  â”‚  â”‚  Device Sim   â”‚  â”‚  Ad Surfer    â”‚                â”‚  â”‚
â”‚  â”‚  â”‚    Tab        â”‚  â”‚   Tab (NEW!)  â”‚                â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚
â”‚  â”‚                            â”‚                          â”‚  â”‚
â”‚  â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚
â”‚  â”‚                     â”‚  AdSurfer Comp.   â”‚            â”‚  â”‚
â”‚  â”‚                     â”‚  - Timer          â”‚            â”‚  â”‚
â”‚  â”‚                     â”‚  - Auto Open      â”‚            â”‚  â”‚
â”‚  â”‚                     â”‚  - Progress Bar   â”‚            â”‚  â”‚
â”‚  â”‚                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚
â”‚  â”‚                            â”‚                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                             â”‚
â”‚  HTTP/API Calls               â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  BACKEND (Express)                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚   API Routes (server/routes.ts)             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  GET  /api/ads              â† Fetch ads   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  POST /api/ads              â† Create ad   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  PUT  /api/ads/:id          â† Update ad   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  DELETE /api/ads/:id        â† Delete ad   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                            â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  POST /api/ad-views         â† Record view â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  GET  /api/ad-stats/:id     â† Statistics â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                   â”‚                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚   Storage Layer (server/storage.ts)   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  MemStorage:                         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - In-memory ads map                â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - View history array              â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - CRUD operations                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - Statistics calculation          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - 3 demo ads pre-loaded           â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                   â”‚                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        DATABASE SCHEMA (shared/schema.ts)    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                              â”‚ â”‚
â”‚  â”‚  Table: ads                Table: ad_views   â”‚ â”‚
â”‚  â”‚  â”œâ”€ id (UUID)             â”œâ”€ id (UUID)      â”‚ â”‚
â”‚  â”‚  â”œâ”€ url                   â”œâ”€ userId         â”‚ â”‚
â”‚  â”‚  â”œâ”€ title                 â”œâ”€ adId (FK)      â”‚ â”‚
â”‚  â”‚  â”œâ”€ description           â”œâ”€ viewedAt       â”‚ â”‚
â”‚  â”‚  â”œâ”€ viewDuration          â””â”€ duration       â”‚ â”‚
â”‚  â”‚  â”œâ”€ isActive                                â”‚ â”‚
â”‚  â”‚  â””â”€ createdAt                               â”‚ â”‚
â”‚  â”‚                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ User Ad Surfing Flow

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User on Dashboard       â”‚
â”‚ Clicks "Ad Surfer" Tab  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Ad Surfer Componentâ”‚
         â”‚ Loads              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Fetch Active Ads   â”‚
         â”‚ GET /api/ads       â”‚
         â”‚ ?active=true       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Ads Received       â”‚
         â”‚ 3+ ads in array    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User Clicks                 â”‚
    â”‚ "Start Surfing" Button      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Set isSurfing = true        â”‚
    â”‚ Set currentAdIndex = 0      â”‚
    â”‚ Set timeRemaining = 25      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ LOOP: Open Next Ad       â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚ 1. window.open(          â”‚
      â”‚    ads[i].url,           â”‚
      â”‚    800x600               â”‚
      â”‚  )                       â”‚
      â”‚ 2. setTimeRemaining =    â”‚
      â”‚    ads[i].duration      â”‚
      â”‚ 3. startInterval()       â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                             â”‚
             â–¼                             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Timer Running   â”‚        â”‚ Every 1s:    â”‚
      â”‚ Countdown       â”‚        â”‚ - Decrement  â”‚
      â”‚ Progress Bar    â”‚        â”‚ - Check if 0 â”‚
      â”‚ Visual Feedback â”‚        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
               â”‚                       â–¼
               â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚              â”‚ When Timer = 0:    â”‚
               â”‚              â”‚ 1. Close ad window â”‚
               â”‚              â”‚ 2. Record view     â”‚
               â”‚              â”‚ POST /api/ad-views â”‚
               â”‚              â”‚ 3. Increment count â”‚
               â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                       â”‚
               â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚        â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚              â”‚
                        â–¼              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ More Ads?    â”‚  â”‚ No More Ads â”‚
                  â”‚ YES: Loop â†’  â”‚  â”‚ Stop        â”‚
                  â”‚ NO: Stop     â”‚  â”‚ Exit Loop   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                          â”‚
                                          â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ setIsSurfing =   â”‚
                                  â”‚ false            â”‚
                                  â”‚ Clear timer      â”‚
                                  â”‚ Reset UI         â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                        END
```

---

## ğŸ“Š Admin Ad Management Flow

```
ADMIN PANEL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /admin/ads                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Fetch All Ads                 â”‚ â”‚
â”‚  â”‚ GET /api/ads (no filter)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                     â”‚
â”‚               â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Display Ads in Table           â”‚ â”‚
â”‚  â”‚ - Title                        â”‚ â”‚
â”‚  â”‚ - URL                          â”‚ â”‚
â”‚  â”‚ - Duration                     â”‚ â”‚
â”‚  â”‚ - Status (Active/Inactive)     â”‚ â”‚
â”‚  â”‚ - Edit/Delete Buttons          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â–¼                               â–¼  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚ Add New Ad  â”‚          â”‚ Edit Ad  â”‚
â”‚ â”‚ Button      â”‚          â”‚ Button   â”‚
â”‚ â”‚             â”‚          â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”‚        â”‚                     â”‚       â”‚
â”‚        â–¼                     â–¼       â–¼
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚ Modal Dialog Opens  â”‚   â”‚ Delete Ad    â”‚
â”‚   â”‚ Form Fields:        â”‚   â”‚ Button       â”‚
â”‚   â”‚ - URL               â”‚   â”‚              â”‚
â”‚   â”‚ - Title             â”‚   â”‚ Confirm?     â”‚
â”‚   â”‚ - Description       â”‚   â”‚ YES/NO       â”‚
â”‚   â”‚ - Duration (20-30)  â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   â”‚                     â”‚          â”‚
â”‚   â”‚ [Create] [Cancel]   â”‚          â–¼
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”‚                â”‚ DELETE      â”‚
â”‚            â–¼                â”‚ /api/ads/:idâ”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ (DELETE)    â”‚
â”‚   â”‚ POST /api/ads       â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”‚   â”‚ PUT /api/ads/:id    â”‚          â”‚
â”‚   â”‚ (with form data)    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚                     â”‚   â”‚ Confirm OK  â”‚
â”‚   â”‚ Response: Ad object â”‚   â”‚ Refresh     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ Table       â”‚
â”‚            â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚            â–¼
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚ Modal Closes        â”‚
â”‚   â”‚ Table Refreshes     â”‚
â”‚   â”‚ New ad appears!     â”‚
â”‚   â”‚ Animation added     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ API Request/Response Cycle

```
CLIENT                              SERVER
  â”‚                                  â”‚
  â”‚  GET /api/ads?active=true       â”‚
  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
  â”‚                                  â”‚
  â”‚                         Validate request
  â”‚                         Query database
  â”‚                    Build response array
  â”‚  â”‚                                  â”‚
  â”‚  â”‚â—„â”€ 200 OK + JSON array of ads  â”‚
  â”‚  â”‚   [{...}, {...}, {...}]       â”‚
  â”‚                                  â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
  â”‚ POST /api/ads                     â”‚
  â”‚ {                                 â”‚
  â”‚   "url": "...",                   â”‚
  â”‚   "title": "...",                 â”‚
  â”‚   "description": "...",           â”‚
  â”‚   "viewDuration": 25              â”‚
  â”‚ }                                 â”‚
  â”‚                                  â”œâ”€ Validate input
  â”‚                                  â”œâ”€ Check required fields
  â”‚                                  â”œâ”€ Create new object
  â”‚                                  â”œâ”€ Generate UUID
  â”‚                                  â”œâ”€ Store in DB
  â”‚                                  â”‚
  â”‚â—„â”€ 201 Created                   â”‚
  â”‚   {                               â”‚
  â”‚     "id": "abc-123...",           â”‚
  â”‚     "url": "...",                 â”‚
  â”‚     "title": "...",               â”‚
  â”‚     "description": "...",         â”‚
  â”‚     "viewDuration": 25,           â”‚
  â”‚     "isActive": true,             â”‚
  â”‚     "createdAt": "2024-01-01" â”‚
  â”‚   }                               â”‚
  â”‚                                  â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
  â”‚ POST /api/ad-views                â”‚
  â”‚ {                                 â”‚
  â”‚   "adId": "abc-123...",           â”‚
  â”‚   "duration": 25                  â”‚
  â”‚ }                                 â”‚
  â”‚                                  â”œâ”€ Get userId from session
  â”‚                                  â”œâ”€ Create view record
  â”‚                                  â”œâ”€ Generate UUID
  â”‚                                  â”œâ”€ Store in DB
  â”‚                                  â”‚
  â”‚â—„â”€ 201 Created                   â”‚
  â”‚   {                               â”‚
  â”‚     "id": "view-456...",          â”‚
  â”‚     "userId": "user-789...",      â”‚
  â”‚     "adId": "abc-123...",         â”‚
  â”‚     "duration": 25,               â”‚
  â”‚     "viewedAt": "2024-01-01" â”‚
  â”‚   }                               â”‚
  â”‚                                  â”‚
```

---

## ğŸ—‚ï¸ File Structure & Dependencies

```
Device-City-Loader/
â”œâ”€â”€ QUICK_START.md                  [NEW] â­ Start here!
â”œâ”€â”€ COMPLETE_OVERVIEW.md            [NEW] â­ Full overview
â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md        [NEW] â­ Technical details
â”œâ”€â”€ AD_SURFER_README.md             [NEW] â­ Feature docs
â”‚
â”œâ”€â”€ client/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ App.tsx                 [MODIFIED] Added /admin/ads route
â”‚       â”‚
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ AdSurfer.tsx        [NEW] â­ Core ad surfing component
â”‚       â”‚   â”œâ”€â”€ Header.tsx
â”‚       â”‚   â”œâ”€â”€ DeviceScreen.tsx
â”‚       â”‚   â””â”€â”€ ui/
â”‚       â”‚       â”œâ”€â”€ tabs.tsx
â”‚       â”‚       â”œâ”€â”€ dialog.tsx
â”‚       â”‚       â”œâ”€â”€ table.tsx
â”‚       â”‚       â”œâ”€â”€ button.tsx
â”‚       â”‚       â”œâ”€â”€ input.tsx
â”‚       â”‚       â”œâ”€â”€ card.tsx
â”‚       â”‚       â””â”€â”€ ... (30+ components)
â”‚       â”‚
â”‚       â””â”€â”€ pages/
â”‚           â”œâ”€â”€ Dashboard.tsx        [MODIFIED] Added Ad Surfer tab
â”‚           â”œâ”€â”€ AdminAds.tsx         [NEW] â­ Ad management panel
â”‚           â””â”€â”€ not-found.tsx
â”‚
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ routes.ts                   [MODIFIED] â­ Added ad API routes
â”‚   â”œâ”€â”€ storage.ts                  [MODIFIED] â­ Added ad operations
â”‚   â”œâ”€â”€ vite.ts
â”‚   â””â”€â”€ static.ts
â”‚
â”œâ”€â”€ shared/
â”‚   â””â”€â”€ schema.ts                   [MODIFIED] â­ Added ads/ad_views tables
â”‚
â”œâ”€â”€ script/
â”‚   â””â”€â”€ build.ts
â”‚
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
â”œâ”€â”€ drizzle.config.ts
â””â”€â”€ postcss.config.js
```

---

## ğŸ“ˆ Data Flow Diagram

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   User Browser      â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                     â”‚
                    â”‚ Dashboard           â”‚
                    â”‚  â”œâ”€ Device Sim Tab  â”‚
                    â”‚  â””â”€ Ad Surfer Tab   â”‚
                    â”‚                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP/JSON
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Express Server    â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                     â”‚
                    â”‚ Routes Handler      â”‚
                    â”‚ â””â”€ /api/ads/*       â”‚
                    â”‚ â””â”€ /api/ad-views    â”‚
                    â”‚                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ JS Objects
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Storage Handler     â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                     â”‚
                    â”‚ MemStorage/DB       â”‚
                    â”‚ â””â”€ Maps & Arrays    â”‚
                    â”‚ â””â”€ CRUD Operations  â”‚
                    â”‚                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                          â”‚                          â”‚
    â–¼                          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ads Map    â”‚          â”‚ Ad_Views     â”‚         â”‚ User Data   â”‚
â”‚             â”‚          â”‚ Array        â”‚         â”‚ (Future)    â”‚
â”‚ {id, url,   â”‚          â”‚              â”‚         â”‚             â”‚
â”‚  title,     â”‚          â”‚ [{userId,    â”‚         â”‚ {id,        â”‚
â”‚  duration,  â”‚          â”‚  adId,       â”‚         â”‚  username,  â”‚
â”‚  ...}       â”‚          â”‚  viewedAt,   â”‚         â”‚  email,     â”‚
â”‚             â”‚          â”‚  duration}]  â”‚         â”‚  ...}       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Component Hierarchy

```
App
â”œâ”€â”€ Router
â”‚   â”œâ”€â”€ Route: "/"
â”‚   â”‚   â””â”€â”€ Dashboard
â”‚   â”‚       â”œâ”€â”€ Header
â”‚   â”‚       â”œâ”€â”€ Tabs
â”‚   â”‚       â”‚   â”œâ”€â”€ TabsList
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ TabsTrigger: "simulator"
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ TabsTrigger: "ads"
â”‚   â”‚       â”‚   â”œâ”€â”€ TabsContent: "simulator"
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ DeviceScreen (x multiple)
â”‚   â”‚       â”‚   â””â”€â”€ TabsContent: "ads"
â”‚   â”‚       â”‚       â””â”€â”€ AdSurfer â­ [NEW]
â”‚   â”‚       â”‚           â”œâ”€â”€ Button: "Start Surfing"
â”‚   â”‚       â”‚           â”œâ”€â”€ Progress: timer
â”‚   â”‚       â”‚           â”œâ”€â”€ Stats display
â”‚   â”‚       â”‚           â””â”€â”€ Button: "Stop Surfing"
â”‚   â”‚       â””â”€â”€ Background effects
â”‚   â”‚
â”‚   â”œâ”€â”€ Route: "/dashboard"
â”‚   â”‚   â””â”€â”€ Dashboard (same as above)
â”‚   â”‚
â”‚   â”œâ”€â”€ Route: "/admin/ads" â­ [NEW]
â”‚   â”‚   â””â”€â”€ AdminAds
â”‚   â”‚       â”œâ”€â”€ Button: "Add New Ad"
â”‚   â”‚       â”œâ”€â”€ Dialog (form)
â”‚   â”‚       â”‚   â”œâ”€â”€ Input: url
â”‚   â”‚       â”‚   â”œâ”€â”€ Input: title
â”‚   â”‚       â”‚   â”œâ”€â”€ Textarea: description
â”‚   â”‚       â”‚   â”œâ”€â”€ Input: duration
â”‚   â”‚       â”‚   â””â”€â”€ Button: submit
â”‚   â”‚       â””â”€â”€ Table
â”‚   â”‚           â”œâ”€â”€ TableHeader
â”‚   â”‚           â””â”€â”€ TableBody
â”‚   â”‚               â””â”€â”€ TableRow (x multiple)
â”‚   â”‚                   â”œâ”€â”€ Title
â”‚   â”‚                   â”œâ”€â”€ URL
â”‚   â”‚                   â”œâ”€â”€ Duration
â”‚   â”‚                   â”œâ”€â”€ Status
â”‚   â”‚                   â”œâ”€â”€ Button: edit
â”‚   â”‚                   â””â”€â”€ Button: delete
â”‚   â”‚
â”‚   â””â”€â”€ Route: "*"
â”‚       â””â”€â”€ NotFound
â”‚
â”œâ”€â”€ QueryClientProvider
â”œâ”€â”€ TooltipProvider
â””â”€â”€ Toaster
```

---

## ğŸ”„ State Management

```
AdSurfer Component State:
  â”œâ”€ ads: Ad[]                  # Array of ads from API
  â”œâ”€ isSurfing: boolean         # Is user surfing?
  â”œâ”€ currentAdIndex: number     # Which ad is showing
  â”œâ”€ timeRemaining: number      # Seconds left for current ad
  â”œâ”€ totalViewed: number        # Total ads viewed this session
  â””â”€ adWindow: Window | null    # Reference to opened ad window

AdminAds Component State:
  â”œâ”€ ads: Ad[]                  # All ads in system
  â”œâ”€ loading: boolean           # Fetching from API
  â”œâ”€ dialogOpen: boolean        # Create/edit form open
  â”œâ”€ editingAd: Ad | null       # Current ad being edited
  â””â”€ formData: {
      â”œâ”€ url: string
      â”œâ”€ title: string
      â”œâ”€ description: string
      â””â”€ viewDuration: number
    }

Dashboard Component State:
  â”œâ”€ screens: Screen[]          # Device simulator screens
  â”œâ”€ globalUrl: string
  â”œâ”€ embedMode: boolean
  â”œâ”€ isAutoRefreshing: boolean
  â”œâ”€ isAutoClicking: boolean
  â””â”€ isAutoSliding: boolean
```

---

This comprehensive architecture shows how every piece connects to form the complete ad surfing system!
